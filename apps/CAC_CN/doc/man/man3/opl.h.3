.TH "C:/Users/Squaria/Documents/openPOWERLINK_V2_CAC/apps/CAC_CN/include/opl.h" 3 "Version 1.2" "CAC main program" \" -*- nroff -*-
.ad l
.nh
.SH NAME
C:/Users/Squaria/Documents/openPOWERLINK_V2_CAC/apps/CAC_CN/include/opl.h \- header file of the OpenPOWERLINK module that communicates with the master board using OpenPOWERLINK  

.SH SYNOPSIS
.br
.PP
\fR#include 'xapOpl\&.h'\fP
.br
\fR#include 'eventOpl\&.h'\fP
.br
\fR#include 'configDefine\&.h'\fP
.br
\fR#include 'nodeId\&.h'\fP
.br
\fR#include 'statusErrorDefine\&.h'\fP
.br
\fR#include 'csv\&.h'\fP
.br
\fR#include 'sensor\&.h'\fP
.br
\fR#include 'valve\&.h'\fP
.br
\fR#include <oplk/oplk\&.h>\fP
.br
\fR#include <oplk/debugstr\&.h>\fP
.br
\fR#include <stddef\&.h>\fP
.br
\fR#include <stdint\&.h>\fP
.br
\fR#include <stdbool\&.h>\fP
.br
\fR#include <inttypes\&.h>\fP
.br
\fR#include <system/system\&.h>\fP
.br
\fR#include <obdcreate/obdcreate\&.h>\fP
.br
\fR#include <getopt/getopt\&.h>\fP
.br
\fR#include <console/console\&.h>\fP
.br
\fR#include <eventlog/eventlog\&.h>\fP
.br
\fR#include <netselect/netselect\&.h>\fP
.br
\fR#include <stdio\&.h>\fP
.br
\fR#include <limits\&.h>\fP
.br
\fR#include <string>\fP
.br

.SS "Classes"

.in +1c
.ti -1c
.RI "struct \fBtOptions\fP"
.br
.RI "the OpenPOWERLINK initialization parameters "
.ti -1c
.RI "class \fBopl\fP"
.br
.RI "OpenPOWERLINK module class\&. "
.in -1c
.SS "Functions"

.in +1c
.ti -1c
.RI "\fBstatusErrDef\fP \fBinitPowerlink\fP (UINT32 cycleLen_p, const char *devName_p, const UINT8 *macAddr_p, UINT32 nodeId_p)"
.br
.RI "Initialize the openPOWERLINK stack\&. "
.ti -1c
.RI "\fBstatusErrDef\fP \fBinitOplThread\fP (void)"
.br
.ti -1c
.RI "\fBstatusErrDef\fP \fBinitProcessImage\fP (void)"
.br
.RI "Initialize process image\&. "
.ti -1c
.RI "\fBstatusErrDef\fP \fBshutdownOplImage\fP (void)"
.br
.RI "Shutdown the synchronous data application\&. "
.ti -1c
.RI "\fBstatusErrDef\fP \fBcheckStateOpl\fP (void)"
.br
.RI "function to check if the OpenPOWERLINK stack crashed or a termination signal has been received from the OS app manager\&. "
.ti -1c
.RI "void \fBshutdownPowerlink\fP (void)"
.br
.RI "Shutdown the demo application\&. "
.ti -1c
.RI "void \fBsetupInputs\fP (void)"
.br
.RI "Setup inputs\&. "
.ti -1c
.RI "tOplkError \fBprocessSync\fP (void)"
.br
.RI "Synchronous data handler\&. "
.ti -1c
.RI "tOplkError \fBlinkPDO_in\fP (tObdSize obdSize, const UINT16 arrayIndex, UINT16 index, UINT8 subIndex)"
.br
.RI "function to link a CN RPDO (recieved process data object) gotten from the mnobd\&.cdc binary file generated by OpenCONFIGURATOR to the OpenPOWERLINK application\&. "
.ti -1c
.RI "tOplkError \fBlinkPDO_out\fP (tObdSize obdSize, const UINT16 arrayIndex, UINT16 index, UINT8 subIndex)"
.br
.RI "function to link a CN TPDO (transmitted process data object) gotten from the mnobd\&.cdc binary file generated by OpenCONFIGURATOR to the OpenPOWERLINK application\&. "
.ti -1c
.RI "\fBstatusErrDef\fP \fBinitOPL\fP ()"
.br
.RI "function to initialize the CN OpenPOWERLINK module "
.ti -1c
.RI "\fBstatusErrDef\fP \fBextinctOPL\fP ()"
.br
.RI "function to shutdown the OpenPOWERLINK module\&. "
.ti -1c
.RI "int16_t \fBgetValues_In_CN\fP (int ligne)"
.br
.RI "function getter of the value coming from the MN from line according to the structure \fBPI_IN\fP "
.ti -1c
.RI "void \fBsetValues_Out_CN\fP ()"
.br
.RI "function setter of the values coming out of the CN namely, the valves and sensors values\&. "
.ti -1c
.RI "int16_t \fBgetValues_Out_CN\fP (int ligne)"
.br
.RI "function getter of the value coming out of the CN from line according to the structure \fBPI_OUT\fP "
.ti -1c
.RI "void \fBsetActivated_Out_CN\fP ()"
.br
.RI "function setter to fill the activation array from the CSV activation file 'activation\&.csv' "
.ti -1c
.RI "void \fBaffValeursIn\fP ()"
.br
.RI "function to display in the console the values coming from the MN "
.ti -1c
.RI "void \fBaffValeursProcessIn\fP ()"
.br
.RI "function to display in the console the values coming from the MN "
.ti -1c
.RI "void \fBaffValeursOut\fP ()"
.br
.RI "function to display in the console the values coming out of the CN "
.ti -1c
.RI "int16_t \fBgetEG\fP ()"
.br
.RI "function getter of the current general state (EG) "
.ti -1c
.RI "\fBstatusErrDef\fP \fBisEGchanged\fP ()"
.br
.RI "function to check if the general state (EG) has been changed "
.ti -1c
.RI "void \fBsetEC\fP (int16_t EC1)"
.br
.RI "function setter of the board state (EC) "
.in -1c
.SS "Variables"

.in +1c
.ti -1c
.RI "int16_t \fBEG\fP"
.br
.RI "the general state from the MN (the OBC)\&. It is initialized to 0 so a general state CSV file with EG = 0x0000 should not exist\&. "
.ti -1c
.RI "int16_t \fBEC\fP"
.br
.RI "the board state of this CN (this CAC board)\&. It is initialized to the copy of the general state EG\&. "
.ti -1c
.RI "const uint16_t \fBnbValuesCN_Out\fP"
.br
.RI "the number of values coming out of each CNs "
.ti -1c
.RI "const uint16_t \fBnbValuesCN_In\fP"
.br
.RI "the number of values coming into each CNs "
.ti -1c
.RI "const uint16_t \fBnbValuesCN_Out_ByCN\fP"
.br
.RI "the first value position coming out of this CN (the position of EC) "
.ti -1c
.RI "const uint16_t \fBnbValuesCN_In_ByCN\fP"
.br
.RI "the first value position coming into this CN (the position of EG) "
.in -1c
.SH "Detailed Description"
.PP 
header file of the OpenPOWERLINK module that communicates with the master board using OpenPOWERLINK 


.PP
\fBAuthor\fP
.RS 4
Mael Parot 
.RE
.PP
\fBVersion\fP
.RS 4
1\&.2 
.RE
.PP
\fBDate\fP
.RS 4
11/04/2024
.RE
.PP
Contains all functions definitions related to communicating with the master board using OpenPOWERLINK, transfer sensors, valves values and recieve orders from the master\&. 
.PP
Definition in file \fBopl\&.h\fP\&.
.SH "Function Documentation"
.PP 
.SS "void affValeursIn ()"

.PP
function to display in the console the values coming from the MN 
.PP
Definition at line \fB139\fP of file \fBopl\&.cpp\fP\&.
.SS "void affValeursOut ()"

.PP
function to display in the console the values coming out of the CN 
.PP
Definition at line \fB169\fP of file \fBopl\&.cpp\fP\&.
.SS "void affValeursProcessIn ()"

.PP
function to display in the console the values coming from the MN 
.PP
Definition at line \fB154\fP of file \fBopl\&.cpp\fP\&.
.SS "\fBstatusErrDef\fP checkStateOpl (void)"

.PP
function to check if the OpenPOWERLINK stack crashed or a termination signal has been received from the OS app manager\&. 
.PP
\fBReturns\fP
.RS 4
statusErrDef that values errSystemSendTerminate if a termination signal has been received or errOplKernelStackDown if the OpenPOWERLINK stack crashed or noError when the function exits successfully\&. 
.RE
.PP

.PP
Definition at line \fB568\fP of file \fBopl\&.cpp\fP\&.
.SS "\fBstatusErrDef\fP extinctOPL ()"

.PP
function to shutdown the OpenPOWERLINK module\&. 
.PP
\fBReturns\fP
.RS 4
statusErrDef that values errOplkFreeProcessImage when the freeing of memory of the OpenPOWERLINK stack fails\&. or noError when the function exits successfully\&. 
.RE
.PP

.PP
Definition at line \fB866\fP of file \fBopl\&.cpp\fP\&.
.SS "int16_t getEG ()"

.PP
function getter of the current general state (EG) 
.PP
\fBReturns\fP
.RS 4
int16_t the current general state (EG) 
.RE
.PP

.PP
Definition at line \fB242\fP of file \fBopl\&.cpp\fP\&.
.SS "int16_t getValues_In_CN (int ligne)"

.PP
function getter of the value coming from the MN from line according to the structure \fBPI_IN\fP 
.PP
\fBParameters\fP
.RS 4
\fIligne\fP the line according to the structure \fBPI_IN\fP 
.RE
.PP
\fBReturns\fP
.RS 4
int16_t the value coming from the MN 
.RE
.PP

.PP
Definition at line \fB186\fP of file \fBopl\&.cpp\fP\&.
.SS "int16_t getValues_Out_CN (int ligne)"

.PP
function getter of the value coming out of the CN from line according to the structure \fBPI_OUT\fP 
.PP
\fBParameters\fP
.RS 4
\fIligne\fP the line according to the structure \fBPI_OUT\fP 
.RE
.PP
\fBReturns\fP
.RS 4
int16_t the value coming out of the CN 
.RE
.PP

.PP
Definition at line \fB219\fP of file \fBopl\&.cpp\fP\&.
.SS "\fBstatusErrDef\fP initOPL ()"

.PP
function to initialize the CN OpenPOWERLINK module 
.PP
\fBReturns\fP
.RS 4
statusErrDef that values errOPLSystemInit when OpenPOWERLINK fails to set the correct configuration for the current operating system\&. or errSelNetInterface when the selection of the network interface fails when in a Windows machine\&. Can be caused by the absence of WinPcap\&. or errInitObjDictionary when the object dictionary header file (objdict\&.h) has incorrect values or syntax\&. or errOplkInit when The OpenPOWERLINK stack fails to initialize, main cause: the stack is not found by the application, check the CN \&.lib files or errOplkCreate when the OpenPOWERLINK stack fails to create a new instance or errOplkAllocProcessImage when the allocation of the input and/or output structure fails because parts of the structure doesn't exist in the objdict\&.h file or errLinkPDOout when an output object (TPDO) doesn't exist for the same reasons above or errLinkPDOin when an input object (RPDO) doesn't exist for the same reasons above or errSendNMTResetCommand when the OpenPOWERLINK reset command fails or noError when the function exits successfully\&. 
.RE
.PP

.PP
Definition at line \fB321\fP of file \fBopl\&.cpp\fP\&.
.SS "\fBstatusErrDef\fP initOplThread (void)"

.IP "\(bu" 2
It creates the sync thread which is responsible for the synchronous data application\&.
.PP
.PP
\fBReturns\fP
.RS 4
statusErrDef that values errSendNMTResetCommand when the OpenPOWERLINK reset command fails or noError when the function exits successfully\&. 
.RE
.PP

.PP
Definition at line \fB539\fP of file \fBopl\&.cpp\fP\&.
.SS "\fBstatusErrDef\fP initPowerlink (UINT32 cycleLen_p, const char * devName_p, const UINT8 * macAddr_p, UINT32 nodeId_p)"

.PP
Initialize the openPOWERLINK stack\&. The function initializes the openPOWERLINK stack\&.
.PP
\fBParameters\fP
.RS 4
\fIcycleLen_p\fP Length of POWERLINK cycle\&. 
.br
\fIdevName_p\fP Device name string\&. 
.br
\fImacAddr_p\fP MAC address to use for POWERLINK interface\&. 
.br
\fInodeId_p\fP POWERLINK node ID\&.
.RE
.PP
\fBReturns\fP
.RS 4
statusErrDef that values errSelNetInterface when the selection of the network interface fails when in a Windows machine can be caused by the absence of WinPcap\&. or errInitObjDictionary when the object dictionary header file (objdict\&.h) has incorrect values or syntax\&. or errOplkInit when the OpenPOWERLINK stack fails maybe because the stack is not found by the application, check the CN \&.lib files\&. or errOplkCreate when the OpenPOWERLINK stack fails to create a new instance or noError when the function exits successfully\&. 
.RE
.PP

.PP
Definition at line \fB407\fP of file \fBopl\&.cpp\fP\&.
.SS "\fBstatusErrDef\fP initProcessImage (void)"

.PP
Initialize process image\&. The function initializes the process image of the application\&.
.PP
\fBReturns\fP
.RS 4
statusErrDef that values errOplkAllocProcessImage when the allocation of the input and/or output structure doesn't exist in the objdict\&.h file or errLinkPDOout when an output object (TPDO) doesn't exist for the same reasons above\&. or errLinkPDOin when an input object (RPDO) doesn't exist for the same reasons above\&. or noError when the function exits successfully\&. 
.RE
.PP

.PP
Definition at line \fB706\fP of file \fBopl\&.cpp\fP\&.
.SS "\fBstatusErrDef\fP isEGchanged ()"

.PP
function to check if the general state (EG) has been changed 
.PP
\fBReturns\fP
.RS 4
statusErrDef infoModeSetToManual if the mode to manual order has been received from the MN or infoEGNotChanged if the EG is still the same\&. 
.RE
.PP

.PP
Definition at line \fB256\fP of file \fBopl\&.cpp\fP\&.
.SS "tOplkError linkPDO_in (tObdSize obdSize, UINT16 arrayIndex, UINT16 index, UINT8 subIndex)"

.PP
function to link a CN RPDO (recieved process data object) gotten from the mnobd\&.cdc binary file generated by OpenCONFIGURATOR to the OpenPOWERLINK application\&. 
.PP
\fBParameters\fP
.RS 4
\fIobdSize\fP the size of the PDO in bytes 
.br
\fIarrayIndex\fP the index of the CN RPDO array 
.br
\fIindex\fP the index of the CN RPDO in the OpenPOWERLINK object library gotten from this file: 00000000_POWERLINK_CiA401_CN\&.xdd 
.br
\fIsubIndex\fP the sub index of the specific object to be linked gotten from this file: 00000000_POWERLINK_CiA401_CN\&.xdd
.RE
.PP
\fBReturns\fP
.RS 4
The function returns a tOplkError error code\&. 
.RE
.PP

.PP
Definition at line \fB795\fP of file \fBopl\&.cpp\fP\&.
.SS "tOplkError linkPDO_out (tObdSize obdSize, UINT16 arrayIndex, UINT16 index, UINT8 subIndex)"

.PP
function to link a CN TPDO (transmitted process data object) gotten from the mnobd\&.cdc binary file generated by OpenCONFIGURATOR to the OpenPOWERLINK application\&. 
.PP
\fBParameters\fP
.RS 4
\fIobdSize\fP the size of the PDO in bytes 
.br
\fIarrayIndex\fP the index of the CN TPDO array 
.br
\fIindex\fP the index of the CN RPDO in the OpenPOWERLINK object library gotten from this file: 00000000_POWERLINK_CiA401_CN\&.xdd 
.br
\fIsubIndex\fP the sub index of the specific object to be linked gotten from this file: 00000000_POWERLINK_CiA401_CN\&.xdd
.RE
.PP
\fBReturns\fP
.RS 4
The function returns a tOplkError error code\&. 
.RE
.PP

.PP
Definition at line \fB835\fP of file \fBopl\&.cpp\fP\&.
.SS "tOplkError processSync (void)"

.PP
Synchronous data handler\&. The function implements the synchronous data handler\&. the valve dependance verification and the sensor reading is called here to trigger valves for every CAC boards (every CNs) at the same time\&.
.PP
\fBReturns\fP
.RS 4
The function returns a tOplkError error code\&. 
.RE
.PP

.PP
Definition at line \fB600\fP of file \fBopl\&.cpp\fP\&.
.SS "void setActivated_Out_CN ()"

.PP
function setter to fill the activation array from the CSV activation file 'activation\&.csv' 
.PP
Definition at line \fB229\fP of file \fBopl\&.cpp\fP\&.
.SS "void setEC (int16_t EC)"

.PP
function setter of the board state (EC) 
.PP
\fBParameters\fP
.RS 4
\fIEC\fP the board state (EC) 
.RE
.PP

.PP
Definition at line \fB287\fP of file \fBopl\&.cpp\fP\&.
.SS "void setupInputs (void)"

.PP
Setup inputs\&. The function initializes the digital input port\&. 
.PP
Definition at line \fB687\fP of file \fBopl\&.cpp\fP\&.
.SS "void setValues_Out_CN ()"

.PP
function setter of the values coming out of the CN namely, the valves and sensors values\&. 
.PP
Definition at line \fB196\fP of file \fBopl\&.cpp\fP\&.
.SS "\fBstatusErrDef\fP shutdownOplImage (void)"

.PP
Shutdown the synchronous data application\&. The function shuts down the synchronous data application
.PP
\fBReturns\fP
.RS 4
statusErrDef that values errOplkFreeProcessImage when the freeing of memory of the OpenPOWERLINK fails\&. or noError when the function exits successfully\&. 
.RE
.PP

.PP
Definition at line \fB886\fP of file \fBopl\&.cpp\fP\&.
.SS "void shutdownPowerlink (void)"

.PP
Shutdown the demo application\&. The function shuts down the demo application\&. 
.PP
Definition at line \fB907\fP of file \fBopl\&.cpp\fP\&.
.SH "Variable Documentation"
.PP 
.SS "int16_t EC\fR [extern]\fP"

.PP
the board state of this CN (this CAC board)\&. It is initialized to the copy of the general state EG\&. 
.PP
Definition at line \fB24\fP of file \fBopl\&.cpp\fP\&.
.SS "int16_t EG\fR [extern]\fP"

.PP
the general state from the MN (the OBC)\&. It is initialized to 0 so a general state CSV file with EG = 0x0000 should not exist\&. 
.PP
Definition at line \fB19\fP of file \fBopl\&.cpp\fP\&.
.SS "const uint16_t nbValuesCN_In\fR [extern]\fP"

.PP
the number of values coming into each CNs 
.PP
Definition at line \fB38\fP of file \fBopl\&.cpp\fP\&.
.SS "const uint16_t nbValuesCN_In_ByCN\fR [extern]\fP"

.PP
the first value position coming into this CN (the position of EG) 
.PP
Definition at line \fB46\fP of file \fBopl\&.cpp\fP\&.
.SS "const uint16_t nbValuesCN_Out\fR [extern]\fP"

.PP
the number of values coming out of each CNs 
.PP
Definition at line \fB34\fP of file \fBopl\&.cpp\fP\&.
.SS "const uint16_t nbValuesCN_Out_ByCN\fR [extern]\fP"

.PP
the first value position coming out of this CN (the position of EC) 
.PP
Definition at line \fB42\fP of file \fBopl\&.cpp\fP\&.
.SH "Author"
.PP 
Generated automatically by Doxygen for CAC main program from the source code\&.
